#!/usr/bin/env ruby

=begin

  Usage:
  hive [options] start | stop | restart | status

  e.g.
  hive --dry-run --verbose --env production --name it --chdir /tmp/it start
  hive /opt/rails/it/current/config/it start
  Options must preceed the command.

  Note: the pid file depends on chdir, env, and name, so you have to specify them for any command to work.
  They can be specified in a configuration file.

=end

# We don't use Bundler because that is up to the client.
# The client can use 'bundle exec hive' if desired.
File.expand_path(File.dirname(__FILE__)+"/../lib").tap { |d| $:.unshift(d) if ! $:.member?(d) }
require "hive"

my = Hive::Configuration.parse(ARGV)
if ! my.dry_run then
  Hive::Daemon.spawn!( my.options_for_daemon_spawn, my.args_for_daemon_spawn )
end

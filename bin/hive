#!/usr/bin/env ruby

File.expand_path(File.dirname(__FILE__)+"/../lib").tap { |d| $:.unshift(d) if ! $:.member?(d) }
require "hive"
require "optparse"

my = Hive::Configuration.parse(ARGV)
if ! my.dry_run then
  Hive::Daemon.spawn!(
    working_dir: my.root,
    log_file:    "#{my.root}/#{my.name}_#{my.env}.log",
    pid_file:    "#{my.root}/#{my.name}_#{my.env}.pid",
    sync_log:    %w(development test).member?(my.env)
  )
end
